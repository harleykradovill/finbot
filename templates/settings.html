<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Borealis | Settings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/site.css') }}">
</head>
<body>
  <header class="navbar" role="banner" aria-label="Primary">
    <nav class="nav-container" role="navigation" aria-label="Main">
      <a class="brand" href="/" aria-label="Borealis Home">
        <img src="{{ url_for('assets', filename='images/borealis_small.png') }}"
             alt="Borealis logo" class="brand-logo">
        <span class="brand-text">Borealis</span>
      </a>
      <ul class="nav-links">
        {% set is_home = request.path == url_for('index') %}
        {% set is_users = request.path == url_for('users') %}
        {% set is_libraries = request.path == url_for('libraries') %}
        {% set is_settings = request.path == url_for('settings') %}
        <li><a href="/" class="{{ 'active' if is_home else '' }}">Home</a></li>
        <li><a href="/users" class="{{ 'active' if is_users else '' }}">Users</a></li>
        <li><a href="/libraries" class="{{ 'active' if is_libraries else '' }}">Libraries</a></li>
        <li><a href="/settings" class="{{ 'active' if is_settings else '' }}">Settings</a></li>
      </ul>
    </nav>
  </header>

  <main id="content" class="content" tabindex="-1">
    {% block content %}{% endblock %}

    <section class="settings-shell" aria-label="Settings">
      <div class="settings-container" role="tablist" aria-orientation="vertical">
        <nav class="settings-nav" aria-label="Sections">
          <a id="general-tab" href="#general" class="settings-tab active" role="tab" aria-selected="true" aria-controls="general" tabindex="0">
            General
          </a>
          <a id="jellyfin-tab" href="#jellyfin" class="settings-tab" role="tab" aria-selected="false" aria-controls="jellyfin" tabindex="-1">
            Jellyfin
          </a>
          <a id="libraries-tab" href="#libraries" class="settings-tab" role="tab" aria-selected="false" aria-controls="libraries" tabindex="-1">
            Libraries
          </a>
          <a id="about-tab" href="#about" class="settings-tab" role="tab" aria-selected="false" aria-controls="about" tabindex="-1">
            About
          </a>
        </nav>

        <div class="settings-content" role="tabpanel" id="general" aria-labelledby="general-tab">
          <div class="settings-placeholder">
            <h2 class="placeholder-title">General</h2>
          </div>

          <form class="settings-form" aria-label="General Settings">
            <div class="form-field">
              <label for="hour-format">Hour Format</label>
              <select id="hour-format" name="hour_format">
                <option value="12">12 Hours</option>
                <option value="24">24 Hours</option>
              </select>
            </div>

            <div class="form-field">
              <label for="language">Language</label>
              <select id="language" name="language">
                <option value="en">English</option>
              </select>
            </div>
          </form>
        </div>

        <div class="settings-content" role="tabpanel" id="jellyfin" aria-labelledby="jellyfin-tab" hidden>
          <div class="settings-placeholder">
            <h2 class="placeholder-title">Jellyfin</h2>
          </div>
          <form class="settings-form" aria-label="Jellyfin Settings">
            <div class="form-field">
              <label for="jf-host">Host</label>
              <input id="jf-host" name="jf_host" type="text" inputmode="url" placeholder="127.0.0.1">
            </div>
            <div class="form-field">
              <label for="jf-port">Port</label>
              <input id="jf-port" name="jf_port" type="text" inputmode="numeric" placeholder="8096">
            </div>
            <div class="form-field" style="grid-column: 1 / -1;">
              <label for="jf-api-key">API Key</label>
              <div class="input-with-action">
                <input id="jf-api-key" name="jf_api_key" type="text" autocomplete="off" placeholder="Paste your API key" aria-describedby="jf-api-help">
                <button type="button" id="jf-api-clear" class="icon-btn" aria-label="Clear API key" title="Clear API key" hidden>x</button>
              </div>
              <div class="form-actions">
                <button type="button" class="btn">Test Connection</button>
                <button type="button" class="btn">Test SystemInfo</button>
                <button type="button" class="btn">Pull Data</button>
              </div>
            </div>
          </form>
        </div>

        <div class="settings-content" role="tabpanel" id="libraries" aria-labelledby="libraries-tab" hidden>
          <div class="settings-placeholder">
            <h2 class="placeholder-title">Libraries</h2>
          </div>

          <div id="libraries-panel" class="settings-content" role="region" aria-label="Analytics Libraries">
            <div id="libraries-empty" class="settings-placeholder" hidden>
              <h3 class="placeholder-title">No libraries found</h3>
              <p>Fetch libraries from Jellyfin and then manage tracking here.</p>
            </div>

            <ul id="libraries-list" class="libraries-list" aria-labelledby="libraries-help" aria-label="Library items"></ul>
          </div>
        </div>

        <div class="settings-content" role="tabpanel" id="about" aria-labelledby="about-tab" hidden>
          <div class="settings-placeholder">
            <h2 class="placeholder-title">About</h2>
          </div>
          <div class="about-list" aria-label="About Borealis">
            <p><strong>Borealis Version:</strong> <span id="borealis-version">0.1.0</span></p>
            <p><strong>Latest Borealis Version:</strong> <span id="borealis-latest">0.1.0</span></p>
            <p>
              <strong>Repository:</strong>
              <a href="https://github.com/harleykradovill/borealis" target="_blank" rel="noopener noreferrer">
                github.com/harleykradovill/borealis
              </a>
            </p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div id="toast-container"
       class="toast-container"
       role="status"
       aria-live="polite"
       aria-atomic="true"></div>

  <script src="../static/js/settings.js"></script>

</body>
</html>